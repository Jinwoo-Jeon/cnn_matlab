[EE837A] Homework ? Make CNN for MNIST dataset

20153542 Jinwoo Jeon
1. 코드 설명 및 실행
매트랩 코드로 구성되어 있음 (repelem 함수 때문에 MATLAB 2015a 이상 버전에서만 실행 가능할듯)
RUN_script.m
- 실행용 스크립트
- preproc_data 주석을 해제하면 데이터를 새로 만들고 init 주석을 해제하면 모델을 새로만듬
- 학습된 모델을 불러오려는 경우 init을 주석처리하고, .mat파일을 수동으로 불러온 뒤 RUN_script.m을 실행하면 됨
- 테스트만 하려는 경우 train을 주석하고 test를 주석해제한 후 실행
preproc_data.m
- MNIST.mat을 로드해서 데이터를 가공하는 스크립트
- Data augmentation 및 Mean제거 (test data에서도 train mean제거)
init.m
- 학습에 필요한 파라미터 및 모델을 정의하는 스크립트
- opt.solver struct에 학습 파라미터가 저장되고, opt.layer struct에 모델 파라미터가 정의됨
makeModel.m
- init.m에서 정의된 모델 파라미터를 바탕으로 weight, bias 등 학습 대상 변수들을 초기화하여 model struct 및 option을 return하는 함수
- weight의 경우 Var(1,0)*sqrt(2/n)으로 초기화
- bias의 경우 0로 초기화
- PReLU의 alpha값은 해당 layer weight로 저장되고 논문에서 사용한 값인 0.25로 초기화
train.m
- 학습 loop를 실행하는 함수
- train data를 batch size대로 나누고 랜덤한 index를 부여함
- learning rate를 iteration이 지나면서 decay 하도록 설정 (inv)
opt.solver.lr = opt.solver.baselr * (1 + opt.solver.gamma ...
            * ((cur_epoch-1)*floor(train_num/batch_num)+cur_iter)) ^ (-opt.solver.power);
- forward.m 함수를 이용하여 각 layer의 output을 계산
- forward 계산결과를 이용하여 Cross Entropy (Softmax output) 나 MSE (MLP output) 를 Cost function으로 계산
- error와 각 layer outut을 이용하여 backward.m 함수를 실행 (back-propagation)
- error와 test 결과를 이용하여 그래프를 plot
test.m
- forward.m 함수를 이용하여 test data에 대한 error rate를 return
forward.m
- CNN model에 input batch를 넣어 각 layer의 output을 return
- Convolution layer
- MAX pooling layer
- Fully-connected layer
- ReLU
- PReLU
- Softmax
- Dropout
backward.m
- forward한 결과와 label과의 에러를 이용하여 back-propagation을 수행하여 weight를 update하는 함수
- Convolution layer
- MAX pooling layer
- Fully-connected layer
- ReLU
- PReLU
- Softmax
- Dropout

2. 성능
